import{g as s,c as e}from"./client-76b8804a.js";import{n as t}from"./quickNotifications-8de91e3f.js";import{c as i}from"./createStatusStore-326fc155.js";const a=i();a.set("LOGGED_OUT");const o=function(){let i={},o=[];const n={REQUEST_PASSWORD_RESET:s`
      mutation RequestPasswordReset($email: String!) {
        requestPasswordReset(email: $email)
      }
    `,RESET_PASSWORD:s`
      mutation ResetPassword($token: String!) {
        resetPassword(token: $token)
      }
    `};function r(s){i=s;for(const s of o)s(i)}return{subscribe:function(s){return o.push(s),s(i),function(){o=o.filter(e=>e!==s)}},login:async function(s,e){a.set("AUTHENTICATING");const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,password:e})},n=await fetch("https://api-kurse.miftahul-ilm.net/auth/login",o);if(n.ok){const{user:s,notifications:e}=await n.json();r({...i,user:s,notifications:e}),a.set("AUTHENTICATED")}else{const{message:s}=await n.json();t.display({message:"Fehler: "+s,level:"error"}),a.set("ERROR")}},logout:async function(){r({...i,user:null}),a.reset()},dismissNotification:async function(s){if(i.notifications.find(e=>e.id==s).is_dismissed)return;a.set("DISMISSING_NOTIFICATION");const e=await fetch("https://api-kurse.miftahul-ilm.net/auth/notifications/${id}/dismiss",{method:"PUT"});if(e.ok)i.notifications.find(e=>e.id==s).is_dismissed=!0,r(i),a.set("DISMISSED_NOTIFICATION");else{const{message:s}=await e.json();t.display({message:"Fehler: "+s,level:"error"}),a.set("ERROR")}},requestPasswordReset:async function(s){a.set("REQUESTING_PASSWORD_RESET");const{data:i,errors:o}=await e.request(n.REQUEST_PASSWORD_RESET,{email:s});o?(a.set("ERROR"),t.display({message:"Fehler: "+o[0].message,level:"error"})):(a.set("REQUESTED_PASSWORD_RESET"),t.display({message:"Eine Email wurde Dir zugesendet."}))},resetPassword:async function(s){a.set("RESETTING_PASSWORD");const{data:i,errors:o}=await e.request(n.RESET_PASSWORD,{token:s});if(!o)return a.set("RESETTED_PASSWORD"),t.display({message:"Passwort wurde zur√ºcksetzen"}),i.resetPassword;a.set("ERROR"),t.display({message:"Fehler: "+o[0].message,level:"error"})}}}();export{a,o as s};
//# sourceMappingURL=session-1b5cfdc6.js.map

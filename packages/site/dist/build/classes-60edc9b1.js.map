{"version":3,"file":"classes-60edc9b1.js","sources":["../../src/stores/classes.js"],"sourcesContent":["import { client, gql } from \"../utils/client\";\nimport { notifications } from \"./quickNotifications\";\nimport createStatusStore from \"../utils/createStatusStore\";\n\nconst status = createStatusStore();\n\nconst queries = {\n  GET: gql`\n    query ListAllClasses($teacher_id: ID) {\n      getClasses(teacher_id: $teacher_id) {\n        id\n        subject\n        level\n        gender\n        price_per_hour\n        times {\n          day\n          from\n          to\n        }\n        name\n        teacher {\n          id\n          first_name\n          last_name\n        }\n        state\n        enrollments {\n          id\n          student {\n            id\n          }\n        }\n      }\n    }\n  `,\n};\n\nfunction createClassesStore() {\n  let classes = [];\n  let subs = [];\n\n  function subscribe(handler) {\n    subs.push(handler);\n    handler(classes);\n\n    return function unsubscribe() {\n      subs = subs.filter((fn) => fn !== handler);\n    };\n  }\n\n  function set(value) {\n    classes = value;\n    for (const fn of subs) fn(classes);\n  }\n\n  async function fetch({ teacher_id } = {}) {\n    status.set(\"FETCHING\");\n\n    const { data, errors } = await client.request(queries.GET, { teacher_id });\n\n    if (errors) {\n      status.set(\"ERROR\");\n\n      notifications.display({\n        message: \"Fehler: \" + errors[0].message,\n        level: \"error\",\n      });\n    } else {\n      set(data.getClasses);\n      status.set(\"FETCHED\");\n    }\n  }\n\n  return { subscribe, fetch };\n}\n\nconst classes = createClassesStore();\n\nexport { classes, status };\n"],"names":["status","createStatusStore","queries","GET","gql","classes","subs","subscribe","handler","push","filter","fn","fetch","async","teacher_id","set","data","errors","client","request","notifications","display","message","level","value","getClasses","createClassesStore"],"mappings":"yJAIK,MAACA,EAASC,IAETC,EAAU,CACdC,IAAKC,CAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAsEL,MAACC,EAvCN,WACE,IAAIA,EAAU,GACVC,EAAO,GAkCX,MAAO,CAAEC,UAhCT,SAAmBC,GAIjB,OAHAF,EAAKG,KAAKD,GACVA,EAAQH,GAED,WACLC,EAAOA,EAAKI,OAAQC,GAAOA,IAAOH,KA2BlBI,MAlBpBC,gBAAqBC,WAAEA,GAAe,IACpCd,EAAOe,IAAI,YAEX,MAAMC,KAAEA,EAAIC,OAAEA,SAAiBC,EAAOC,QAAQjB,EAAQC,IAAK,CAAEW,WAAAA,IAEzDG,GACFjB,EAAOe,IAAI,SAEXK,EAAcC,QAAQ,CACpBC,QAAS,WAAaL,EAAO,GAAGK,QAChCC,MAAO,aAfb,SAAaC,GACXnB,EAAUmB,EACV,IAAK,MAAMb,KAAML,EAAMK,EAAGN,GAgBxBU,CAAIC,EAAKS,YACTzB,EAAOe,IAAI,cAODW"}